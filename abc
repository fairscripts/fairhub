--[[ 
    Script: Seguir modelos de listas selecionadas + interagir com prompt
    Extras: UI com bot√µes de ativa√ß√£o, cooldown, webhook no Discord
--]]

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

local LocalPlayer = Players.LocalPlayer or Players.PlayerAdded:Wait()

-- ======== CONFIGURA√á√ïES ========
local WEBHOOK_URL = "https://discord.com/api/webhooks/1403719213041979473/v9JR-9UaJcWuMh7DOItEZOhSt4IZVe4CIt-fTcbXFfu4M3g8JrFTCc2giehRUkIIPGNL"

-- Listas
local lists = {
    Secrets = {
        "La Vacca Saturno Saturnita",
        "Chimpanzini Spiderini",
        "Agarrini la Palini",
        "Los Tralaleritos",
        "Las Tralaleritas",
        "Las Vaquitas Saturnitas",
        "Graipuss Medussi",
        "Chicleteira Bicicleteira",
        "La Grande Combinasion",
        "Los Combinasionas",
        "Nuclearo Dinossauro",
        "Garama and Madundung",
        "Dragon Cannelloni",
        "Secret Lucky Block",
        "Pot Hotspot"
    },
    BrainrotGods = {
        "Cocofanto Elefanto",
        "Girafa Celestre",
        "Gattatino Neonino",
        "Matteo",
        "Tralalero Tralala",
        "Los Crocodillitos",
        "Espresso Signora",
        "Odin Din Din Dun",
        "Statutino Libertino",
        "Tukanno Bananno",
        "Trenostruzzo Turbo 3000",
        "Trippi Troppi Troppa Trippa",
        "Ballerino Lololo",
        "Los Tungtungtungcitos",
        "Piccione Macchina",
        "Brainrot God Lucky Block",
        "Orcalero Orcala"
    },
    Test = {
        "Tung Tung Tung Sahur"
    }
}

-- Estado dos bot√µes
local activeLists = {
    Secrets = false,
    BrainrotGods = false,
    Test = false
}

-- ======== UI ========
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui

local function createButton(text, pos, callback)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 200, 0, 50)
    button.Position = pos
    button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 18
    button.Text = text .. " (OFF)"
    button.Parent = ScreenGui

    button.MouseButton1Click:Connect(function()
        local state = not activeLists[text]
        activeLists[text] = state
        button.Text = text .. (state and " (ON)" or " (OFF)")
        button.BackgroundColor3 = state and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(40, 40, 40)
        callback(state)
    end)
end

createButton("Secrets", UDim2.new(0, 20, 0, 100), function(state) end)
createButton("BrainrotGods", UDim2.new(0, 20, 0, 160), function(state) end)
createButton("Test", UDim2.new(0, 20, 0, 220), function(state) end)

-- ======== FUN√á√ïES ========

-- Fun√ß√£o para enviar webhook
local function sendDiscordWebhook(content)
    local payload = HttpService:JSONEncode({ content = content })
    local success, err = pcall(function()
        HttpService:PostAsync(WEBHOOK_URL, payload, Enum.HttpContentType.ApplicationJson)
    end)
    if not success then
        warn("[Webhook] Erro ao enviar:", err)
    end
end

-- Fun√ß√£o para esperar Character pronto
local function waitForCharacterParts(timeout)
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local ok = pcall(function() char:WaitForChild("Humanoid", timeout) end)
    local ok2 = pcall(function() char:WaitForChild("HumanoidRootPart", timeout) end)
    return char, (ok and char:FindFirstChildOfClass("Humanoid")), (ok2 and char:FindFirstChild("HumanoidRootPart"))
end

-- Detectar fun√ß√£o de fireProximityPrompt
local firePromptFn
if typeof(fireproximityprompt) == "function" then
    firePromptFn = fireproximityprompt
elseif typeof(fireProximityPrompt) == "function" then
    firePromptFn = fireProximityPrompt
end

local function safeFirePrompt(prompt, holdTime)
    holdTime = holdTime or 2
    if not prompt or not prompt:IsA("ProximityPrompt") then return false end
    if firePromptFn then
        local ok, err = pcall(function() firePromptFn(prompt, holdTime) end)
        if ok then return true end
        warn("[safeFirePrompt] pcall falhou:", err)
    end
    return false
end

-- Achar prompt no modelo
local function acharPrompt(model)
    for _,desc in ipairs(model:GetDescendants()) do
        if desc:IsA("ProximityPrompt") then
            return desc
        end
    end
    return nil
end

-- Achar parte alvo pra seguir
local function acharParteAlvo(model)
    if not model then return nil end
    local try = model:FindFirstChild("HumanoidRootPart") or model:FindFirstChild("RootPart") or model.PrimaryPart
    if try and try:IsA("BasePart") then return try end
    for _,v in ipairs(model:GetDescendants()) do
        if v:IsA("BasePart") then return v end
    end
    return nil
end

-- Seguir modelo e interagir
local function seguirEInteragirAteSumir(model)
    if not model or not model.Parent then return end
    local char, humanoid, hrp = waitForCharacterParts(5)
    if not char or not humanoid or not hrp then return end

    local lastFireTime, tentativas = 0, 0
    local connection
    connection = RunService.Heartbeat:Connect(function()
        if not model or not model.Parent then
            connection:Disconnect()
            return
        end

        local targetPart = acharParteAlvo(model)
        if targetPart then
            local dist = (hrp.Position - targetPart.Position).Magnitude
            if dist > 2.2 then
                pcall(function() humanoid:MoveTo(targetPart.Position) end)
            end
        end

        local prompt = acharPrompt(model)
        if prompt then
            local pparent = prompt.Parent
            local promptPos = nil
            if pparent and pparent:IsA("BasePart") then
                promptPos = pparent.Position
            elseif pparent and pparent:IsA("Attachment") and pparent.Parent:IsA("BasePart") then
                promptPos = (pparent.Parent.CFrame * CFrame.new(pparent.Position)).p
            end
            local canTry = true
            local distPrompt = math.huge
            if promptPos then
                distPrompt = (hrp.Position - promptPos).Magnitude
                if distPrompt > (prompt.MaxActivationDistance + 6) then
                    canTry = false
                end
            end
            if canTry and distPrompt <= 10 then
                if tentativas >= 5 then
                    connection:Disconnect()
                    return
                end
                if tick() - lastFireTime >= 2 then
                    safeFirePrompt(prompt, 2)
                    tentativas = tentativas + 1
                    lastFireTime = tick()
                end
            end
        end
    end)
end

-- ======== MONITOR PRINCIPAL ========
local movingAnimals = Workspace:WaitForChild("MovingAnimals")
movingAnimals.ChildAdded:Connect(function(model)
    if not model:IsA("Model") then return end
    task.wait(0.3) -- espera a hierarquia

    local infoFolder = model:FindFirstChild("HumanoidRootPart") and model.HumanoidRootPart:FindFirstChild("Info")
    if not infoFolder then return end

    local displayLabel = infoFolder:FindFirstChild("DisplayName", true)
    if displayLabel and displayLabel:IsA("TextLabel") then
        local txt = displayLabel.Text or ""
        for listName, names in pairs(lists) do
            if activeLists[listName] then
                for _, name in ipairs(names) do
                    if txt == name then
                        sendDiscordWebhook("üîç Encontrado: **"..txt.."** na lista **"..listName.."**!")
                        task.spawn(function()
                            seguirEInteragirAteSumir(model)
                        end)
                        return
                    end
                end
            end
        end
    end
end)

print("[Script] Pronto com UI, follow, prompt e webhook.")
